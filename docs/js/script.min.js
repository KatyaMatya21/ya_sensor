var buttonMenu=document.querySelector(".js-menu-button"),menu=document.querySelector(".header-menu");buttonMenu.addEventListener("click",function(){menu.classList.toggle("header-menu--opened")});var data,grid=document.querySelector(".grid"),template=document.querySelector("#moduleTemplate"),moduleTemplate=template.content.querySelector(".module"),modulePicture=template.content.querySelector(".module__picture"),moduleDetails=template.content.querySelector(".module__cam-details"),xhr=new XMLHttpRequest;xhr.open("GET","events.json",!1),xhr.send(),200!=xhr.status?alert(xhr.status+": "+xhr.statusText):data=JSON.parse(xhr.responseText);var events=data.events;function createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}function parseTemplate(e,t){var r=e.outerHTML;return Object.keys(t).forEach(function(e){null===t[e]&&(t[e]=""),r=r.replace("{{ "+e+" }}",t[e])}),createElementFromHTML(r)}for(var i=0;i<events.length;i++){var module=moduleTemplate.cloneNode(!0);if(module=parseTemplate(moduleTemplate,events[i]),""===events[i].description&&module.querySelector(".module__message").classList.add("module__message--disabled"),"data"in events[i]&&"cam"===events[i].icon){var picture=modulePicture.cloneNode(!0),details=moduleDetails.cloneNode(!0);module.querySelector(".module__message").appendChild(picture),module.querySelector(".module__message").appendChild(details)}grid.appendChild(module)}var imageContainer=document.querySelector(".module__picture"),image=document.querySelector(".module__image"),imageIndicator=document.querySelector(".module__indicator"),imageWindow=imageContainer.offsetWidth,imageWidth=image.offsetWidth,pointerArray=[],distancePrev=0,currentScale=1;image.style.left="0px",imageIndicator.style.left="0px",image.style.transform="scale("+currentScale+")";var moveToStartPosition=function(){imageWindow=imageContainer.offsetWidth,image.style.left="0px",imageIndicator.style.left="0px",image.style.transform="scale(1)",imageWindow=imageContainer.offsetWidth,imageWidth=image.offsetWidth};window.addEventListener("resize",function(){moveToStartPosition()}),imageContainer.addEventListener("pointerdown",function(e){imageContainer.setPointerCapture(e.pointerId),pointerArray.push({id:e.pointerId,prevPosition:{x:e.x,y:e.y},currentPosition:{x:e.x,y:e.y}})}),imageContainer.addEventListener("pointermove",function(e){if(0!==pointerArray.length){for(var t=null,r=0;r<pointerArray.length;r++)if(pointerArray[r].id===e.pointerId){t=r;break}if(pointerArray[t].currentPosition.x=e.x,pointerArray[t].currentPosition.y=e.y,1<pointerArray.length){var n=pointerArray[0].currentPosition.x,i=pointerArray[0].currentPosition.y,o=pointerArray[1].currentPosition.x,a=pointerArray[1].currentPosition.y,l=Math.sqrt(Math.pow(o-n,2)+Math.pow(a-i,2));if(distancePrev){distancePrev<l?currentScale+=.01:(currentScale-=.01)<=1&&(currentScale=1),image.style.transform="scale("+currentScale+")"}distancePrev=l}else{var d=pointerArray[t].prevPosition.x,m=e.x,s=m-d,u=1*image.style.left.replace("px","");0<s?u+=Math.abs(s):u-=Math.abs(s),0<u&&(u=0),u<imageWindow-imageWidth&&(u=imageWindow-imageWidth),image.style.left=u+"px",pointerArray[t].prevPosition.x=m}}}),imageContainer.addEventListener("pointerup",function(e){for(var t=null,r=0;r<pointerArray.length;r++)pointerArray[r].id===e.pointerId&&(t=r);pointerArray.splice(pointerArray[t],1)}),imageContainer.addEventListener("pointercancel",moveToStartPosition);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJidXR0b25NZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJkYXRhIiwiZ3JpZCIsInRlbXBsYXRlIiwibW9kdWxlVGVtcGxhdGUiLCJjb250ZW50IiwibW9kdWxlUGljdHVyZSIsIm1vZHVsZURldGFpbHMiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJzZW5kIiwic3RhdHVzIiwiYWxlcnQiLCJzdGF0dXNUZXh0IiwiSlNPTiIsInBhcnNlIiwicmVzcG9uc2VUZXh0IiwiZXZlbnRzIiwiY3JlYXRlRWxlbWVudEZyb21IVE1MIiwiaHRtbFN0cmluZyIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJ0cmltIiwiZmlyc3RDaGlsZCIsInBhcnNlVGVtcGxhdGUiLCJ2YXJpYWJsZXMiLCJyZXN1bHQiLCJvdXRlckhUTUwiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImtleSIsInJlcGxhY2UiLCJpIiwibGVuZ3RoIiwibW9kdWxlIiwiY2xvbmVOb2RlIiwiZGVzY3JpcHRpb24iLCJhZGQiLCJpY29uIiwicGljdHVyZSIsImRldGFpbHMiLCJhcHBlbmRDaGlsZCIsImltYWdlQ29udGFpbmVyIiwiaW1hZ2UiLCJpbWFnZUluZGljYXRvciIsImltYWdlV2luZG93Iiwib2Zmc2V0V2lkdGgiLCJpbWFnZVdpZHRoIiwicG9pbnRlckFycmF5IiwiZGlzdGFuY2VQcmV2IiwiY3VycmVudFNjYWxlIiwic3R5bGUiLCJsZWZ0IiwidHJhbnNmb3JtIiwibW92ZVRvU3RhcnRQb3NpdGlvbiIsIndpbmRvdyIsImV2ZW50Iiwic2V0UG9pbnRlckNhcHR1cmUiLCJwb2ludGVySWQiLCJwdXNoIiwiaWQiLCJwcmV2UG9zaXRpb24iLCJ4IiwieSIsImN1cnJlbnRQb3NpdGlvbiIsImluZGV4IiwiY3VycmVudFBvc2l0aW9uWDEiLCJjdXJyZW50UG9zaXRpb25ZMSIsImN1cnJlbnRQb3NpdGlvblgyIiwiY3VycmVudFBvc2l0aW9uWTIiLCJkaXN0YW5jZSIsIk1hdGgiLCJzcXJ0IiwicG93Iiwic3RhcnRYIiwiZHgiLCJhYnMiLCJzcGxpY2UiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFdBQWFDLFNBQVNDLGNBQWMsbUJBQ3BDQyxLQUFPRixTQUFTQyxjQUFjLGdCQUVsQ0YsV0FBV0ksaUJBQWlCLFFBQVMsV0FDbkNELEtBQUtFLFVBQVVDLE9BQU8seUJBR3hCLElBUUlDLEtBUkFDLEtBQU9QLFNBQVNDLGNBQWMsU0FFOUJPLFNBQVdSLFNBQVNDLGNBQWMsbUJBRWxDUSxlQUFpQkQsU0FBU0UsUUFBUVQsY0FBYyxXQUNoRFUsY0FBZ0JILFNBQVNFLFFBQVFULGNBQWMsb0JBQy9DVyxjQUFnQkosU0FBU0UsUUFBUVQsY0FBYyx3QkFJL0NZLElBQU0sSUFBSUMsZUFDZEQsSUFBSUUsS0FBSyxNQUFPLGVBQWUsR0FDL0JGLElBQUlHLE9BQ2MsS0FBZEgsSUFBSUksT0FDTkMsTUFBT0wsSUFBSUksT0FBUyxLQUFPSixJQUFJTSxZQUUvQmIsS0FBT2MsS0FBS0MsTUFBTVIsSUFBSVMsY0FHeEIsSUFBSUMsT0FBU2pCLEtBQUtpQixPQUVsQixTQUFTQyxzQkFBc0JDLEdBQzdCLElBQUlDLEVBQU0xQixTQUFTMkIsY0FBYyxPQUVqQyxPQURBRCxFQUFJRSxVQUFZSCxFQUFXSSxPQUNwQkgsRUFBSUksV0FHYixTQUFTQyxjQUFjdkIsRUFBVXdCLEdBQy9CLElBQUlDLEVBQVN6QixFQUFTMEIsVUFPdEIsT0FOQUMsT0FBT0MsS0FBS0osR0FBV0ssUUFBUSxTQUFVQyxHQUNoQixPQUFuQk4sRUFBVU0sS0FDWk4sRUFBVU0sR0FBTyxJQUVuQkwsRUFBU0EsRUFBT00sUUFBUSxNQUFRRCxFQUFNLE1BQU9OLEVBQVVNLE1BRWxEZCxzQkFBc0JTLEdBRy9CLElBQUssSUFBSU8sRUFBSSxFQUFHQSxFQUFJakIsT0FBT2tCLE9BQVFELElB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dkIsSUFDRkEsRUFBTyxHQUdMQSxFQUFPUCxZQUFjRSxhQUN2QkssRUFBT1AsWUFBY0UsWUFHdkJKLE1BQU1RLE1BQU1DLEtBQU9BLEVBQU8sS0FFMUJKLGFBQWFpQixHQUFPSixhQUFhQyxFQUFJQSxNQUl6Q3BCLGVBQWUvQyxpQkFBaUIsWUFBYSxTQUFVNkQsR0FHckQsSUFGQSxJQUFJUyxFQUFRLEtBRUhqQyxFQUFJLEVBQUdBLEVBQUlnQixhQUFhZixPQUFRRCxJQUNuQ2dCLGFBQWFoQixHQUFHNEIsS0FBT0osRUFBTUUsWUFDL0JPLEVBQVFqQyxHQUlaZ0IsYUFBYTZCLE9BQU83QixhQUFhaUIsR0FBUSxLQUczQ3ZCLGVBQWUvQyxpQkFBaUIsZ0JBQWlCMkQiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBidXR0b25NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtYnV0dG9uJyk7XG52YXIgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItbWVudScpO1xuXG5idXR0b25NZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1tZW51LS1vcGVuZWQnKTtcbn0pO1xuXG52YXIgZ3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ncmlkJyk7XG5cbnZhciB0ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtb2R1bGVUZW1wbGF0ZScpO1xuXG52YXIgbW9kdWxlVGVtcGxhdGUgPSB0ZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGUnKTtcbnZhciBtb2R1bGVQaWN0dXJlID0gdGVtcGxhdGUuY29udGVudC5xdWVyeVNlbGVjdG9yKCcubW9kdWxlX19waWN0dXJlJyk7XG52YXIgbW9kdWxlRGV0YWlscyA9IHRlbXBsYXRlLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZV9fY2FtLWRldGFpbHMnKTtcblxudmFyIGRhdGE7XG5cbnZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbnhoci5vcGVuKCdHRVQnLCAnZXZlbnRzLmpzb24nLCBmYWxzZSk7XG54aHIuc2VuZCgpO1xuaWYgKHhoci5zdGF0dXMgIT0gMjAwKSB7XG4gIGFsZXJ0KCB4aHIuc3RhdHVzICsgJzogJyArIHhoci5zdGF0dXNUZXh0ICk7XG59IGVsc2Uge1xuICBkYXRhID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbn1cblxudmFyIGV2ZW50cyA9IGRhdGEuZXZlbnRzO1xuXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50RnJvbUhUTUwoaHRtbFN0cmluZykge1xuICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi5pbm5lckhUTUwgPSBodG1sU3RyaW5nLnRyaW0oKTtcbiAgcmV0dXJuIGRpdi5maXJzdENoaWxkO1xufVxuXG5mdW5jdGlvbiBwYXJzZVRlbXBsYXRlKHRlbXBsYXRlLCB2YXJpYWJsZXMpIHtcbiAgdmFyIHJlc3VsdCA9IHRlbXBsYXRlLm91dGVySFRNTDtcbiAgT2JqZWN0LmtleXModmFyaWFibGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBpZiAodmFyaWFibGVzW2tleV0gPT09IG51bGwpIHtcbiAgICAgIHZhcmlhYmxlc1trZXldID0gJyc7XG4gICAgfVxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKCd7eyAnICsga2V5ICsgJyB9fScsIHZhcmlhYmxlc1trZXldKTtcbiAgfSk7XG4gIHJldHVybiBjcmVhdGVFbGVtZW50RnJvbUhUTUwocmVzdWx0KTtcbn1cblxuZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcblxuICB2YXIgbW9kdWxlID0gbW9kdWxlVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICBtb2R1bGUgPSBwYXJzZVRlbXBsYXRlKG1vZHVsZVRlbXBsYXRlLCBldmVudHNbaV0pO1xuXG4gIGlmIChldmVudHNbaV0uZGVzY3JpcHRpb24gPT09ICcnKSB7XG4gICAgbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX21lc3NhZ2UnKS5jbGFzc0xpc3QuYWRkKCdtb2R1bGVfX21lc3NhZ2UtLWRpc2FibGVkJyk7XG4gIH1cblxuICBpZiAoJ2RhdGEnIGluIGV2ZW50c1tpXSkge1xuXG4gICAgaWYgKGV2ZW50c1tpXS5pY29uID09PSAnY2FtJykge1xuICAgICAgdmFyIHBpY3R1cmUgPSBtb2R1bGVQaWN0dXJlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHZhciBkZXRhaWxzID0gbW9kdWxlRGV0YWlscy5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBtb2R1bGUucXVlcnlTZWxlY3RvcignLm1vZHVsZV9fbWVzc2FnZScpLmFwcGVuZENoaWxkKHBpY3R1cmUpO1xuICAgICAgbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX21lc3NhZ2UnKS5hcHBlbmRDaGlsZChkZXRhaWxzKTtcbiAgICB9XG5cbiAgfVxuXG4gIGdyaWQuYXBwZW5kQ2hpbGQobW9kdWxlKTtcbn1cblxudmFyIGltYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZV9fcGljdHVyZScpO1xudmFyIGltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZV9faW1hZ2UnKTtcbnZhciBpbWFnZUluZGljYXRvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX2luZGljYXRvcicpO1xuXG52YXIgaW1hZ2VXaW5kb3cgPSBpbWFnZUNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbnZhciBpbWFnZVdpZHRoID0gaW1hZ2Uub2Zmc2V0V2lkdGg7XG5cbnZhciBwb2ludGVyQXJyYXkgPSBbXTtcbnZhciBkaXN0YW5jZVByZXYgPSAwO1xudmFyIGN1cnJlbnRTY2FsZSA9IDE7XG5cbmltYWdlLnN0eWxlLmxlZnQgPSAnMHB4JztcbmltYWdlSW5kaWNhdG9yLnN0eWxlLmxlZnQgPSAnMHB4JztcbmltYWdlLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBjdXJyZW50U2NhbGUgKyBcIilcIjtcblxudmFyIG1vdmVUb1N0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgaW1hZ2VXaW5kb3cgPSBpbWFnZUNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgaW1hZ2Uuc3R5bGUubGVmdCA9ICcwcHgnO1xuICBpbWFnZUluZGljYXRvci5zdHlsZS5sZWZ0ID0gJzBweCc7XG4gIGltYWdlLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyAxICsgXCIpXCI7XG5cbiAgaW1hZ2VXaW5kb3cgPSBpbWFnZUNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgaW1hZ2VXaWR0aCA9IGltYWdlLm9mZnNldFdpZHRoO1xufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICBtb3ZlVG9TdGFydFBvc2l0aW9uKCk7XG59KTtcblxuaW1hZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaW1hZ2VDb250YWluZXIuc2V0UG9pbnRlckNhcHR1cmUoZXZlbnQucG9pbnRlcklkKTtcblxuICBwb2ludGVyQXJyYXkucHVzaCh7XG4gICAgaWQ6IGV2ZW50LnBvaW50ZXJJZCxcbiAgICBwcmV2UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfSxcbiAgICBjdXJyZW50UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfVxuICB9KTtcbn0pO1xuXG5pbWFnZUNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIGZ1bmN0aW9uIChldmVudCkge1xuICBpZiAocG9pbnRlckFycmF5Lmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVyblxuICB9XG5cbiAgdmFyIGluZGV4ID0gbnVsbDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50ZXJBcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChwb2ludGVyQXJyYXlbaV0uaWQgPT09IGV2ZW50LnBvaW50ZXJJZCkge1xuICAgICAgaW5kZXggPSBpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcG9pbnRlckFycmF5W2luZGV4XS5jdXJyZW50UG9zaXRpb24ueCA9IGV2ZW50Lng7XG4gIHBvaW50ZXJBcnJheVtpbmRleF0uY3VycmVudFBvc2l0aW9uLnkgPSBldmVudC55O1xuXG4gIGlmIChwb2ludGVyQXJyYXkubGVuZ3RoID4gMSkge1xuXG4gICAgdmFyIGN1cnJlbnRQb3NpdGlvblgxID0gcG9pbnRlckFycmF5WzBdLmN1cnJlbnRQb3NpdGlvbi54O1xuICAgIHZhciBjdXJyZW50UG9zaXRpb25ZMSA9IHBvaW50ZXJBcnJheVswXS5jdXJyZW50UG9zaXRpb24ueTtcbiAgICB2YXIgY3VycmVudFBvc2l0aW9uWDIgPSBwb2ludGVyQXJyYXlbMV0uY3VycmVudFBvc2l0aW9uLng7XG4gICAgdmFyIGN1cnJlbnRQb3NpdGlvblkyID0gcG9pbnRlckFycmF5WzFdLmN1cnJlbnRQb3NpdGlvbi55O1xuXG4gICAgdmFyIGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KChjdXJyZW50UG9zaXRpb25YMiAtIGN1cnJlbnRQb3NpdGlvblgxKSwgMikgKyBNYXRoLnBvdygoY3VycmVudFBvc2l0aW9uWTIgLSBjdXJyZW50UG9zaXRpb25ZMSksIDIpKTtcblxuICAgIGlmIChkaXN0YW5jZVByZXYpIHtcblxuICAgICAgdmFyIHNjYWxlID0gMC4wMTtcblxuICAgICAgaWYgKGRpc3RhbmNlID4gZGlzdGFuY2VQcmV2KSB7XG4gICAgICAgIGN1cnJlbnRTY2FsZSArPSBzY2FsZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRTY2FsZSAtPSBzY2FsZTtcblxuICAgICAgICBpZiAoY3VycmVudFNjYWxlIDw9IDEpIHtcbiAgICAgICAgICBjdXJyZW50U2NhbGUgPSAxO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGltYWdlLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBjdXJyZW50U2NhbGUgKyBcIilcIjtcbiAgICB9XG5cbiAgICBkaXN0YW5jZVByZXYgPSBkaXN0YW5jZTtcblxuICB9IGVsc2Uge1xuXG4gICAgdmFyIHN0YXJ0WCA9IHBvaW50ZXJBcnJheVtpbmRleF0ucHJldlBvc2l0aW9uLng7XG4gICAgdmFyIHggPSBldmVudC54O1xuICAgIHZhciBkeCA9IHggLSBzdGFydFg7XG4gICAgdmFyIGxlZnQgPSBpbWFnZS5zdHlsZS5sZWZ0LnJlcGxhY2UoJ3B4JywgJycpICogMTtcblxuICAgIGR4ID4gMCA/IGxlZnQgKz0gTWF0aC5hYnMoZHgpIDogbGVmdCAtPSBNYXRoLmFicyhkeCk7XG5cbiAgICBpZiAobGVmdCA+IDApIHtcbiAgICAgIGxlZnQgPSAwO1xuICAgIH1cblxuICAgIGlmIChsZWZ0IDwgaW1hZ2VXaW5kb3cgLSBpbWFnZVdpZHRoKSB7XG4gICAgICBsZWZ0ID0gaW1hZ2VXaW5kb3cgLSBpbWFnZVdpZHRoO1xuICAgIH1cblxuICAgIGltYWdlLnN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcblxuICAgIHBvaW50ZXJBcnJheVtpbmRleF0ucHJldlBvc2l0aW9uLnggPSB4O1xuICB9XG59KTtcblxuaW1hZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gIHZhciBpbmRleCA9IG51bGw7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludGVyQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAocG9pbnRlckFycmF5W2ldLmlkID09PSBldmVudC5wb2ludGVySWQpIHtcbiAgICAgIGluZGV4ID0gaTtcbiAgICB9XG4gIH1cblxuICBwb2ludGVyQXJyYXkuc3BsaWNlKHBvaW50ZXJBcnJheVtpbmRleF0sIDEpO1xufSk7XG5cbmltYWdlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJjYW5jZWwnLCBtb3ZlVG9TdGFydFBvc2l0aW9uKTtcblxuIl19
