var buttonMenu=document.querySelector(".js-menu-button"),menu=document.querySelector(".header-menu");buttonMenu.addEventListener("click",function(){menu.classList.toggle("header-menu--opened")});var data,grid=document.querySelector(".grid"),template=document.querySelector("#moduleTemplate"),moduleTemplate=template.content.querySelector(".module"),modulePicture=template.content.querySelector(".module__picture"),xhr=new XMLHttpRequest;xhr.open("GET","events.json",!1),xhr.send(),200!=xhr.status?alert(xhr.status+": "+xhr.statusText):data=JSON.parse(xhr.responseText);var events=data.events;function createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}function parseTemplate(e,t){var r=e.outerHTML;return Object.keys(t).forEach(function(e){null===t[e]&&(t[e]=""),r=r.replace("{{ "+e+" }}",t[e])}),createElementFromHTML(r)}for(var i=0;i<events.length;i++){var module=moduleTemplate.cloneNode(!0);if(module=parseTemplate(moduleTemplate,events[i]),""===events[i].description&&module.querySelector(".module__message").classList.add("module__message--disabled"),"data"in events[i]&&"cam"===events[i].icon){var picture=modulePicture.cloneNode(!0);module.querySelector(".module__message").appendChild(picture)}grid.appendChild(module)}var imageContainer=document.querySelector(".module__picture"),image=document.querySelector(".module__image"),imageWindow=imageContainer.offsetWidth,imageWidth=image.offsetWidth;image.style.left="0px";var pointerArray=[],distancePrev=0,moveToStartPosition=function(){imageWindow=imageContainer.offsetWidth,image.style.left="0px"};window.addEventListener("resize",function(){moveToStartPosition()}),imageContainer.addEventListener("pointerdown",function(e){imageContainer.setPointerCapture(e.pointerId),pointerArray.push({id:e.pointerId,prevPosition:{x:e.x,y:e.y},currentPosition:{x:e.x,y:e.y}}),console.log("down")}),imageContainer.addEventListener("pointermove",function(e){if(0!==pointerArray.length){for(var t=null,r=0;r<pointerArray.length;r++)if(pointerArray[r].id===e.pointerId){t=r;break}if(pointerArray[t].currentPosition.x=e.x,pointerArray[t].currentPosition.y=e.y,console.log("move"),1<pointerArray.length){var n=pointerArray[0].currentPosition.x,o=pointerArray[0].currentPosition.y,i=pointerArray[1].currentPosition.x,a=pointerArray[1].currentPosition.y,d=Math.sqrt(Math.pow(i-n)+Math.pow(a-o));distancePrev&&(document.querySelector("body").style.background=distancePrev<d?"red":"blue"),distancePrev=d,document.querySelector(".debug").innerHTML=distancePrev}else{var u=pointerArray[t].prevPosition.x,l=e.x,s=l-u,m=1*image.style.left.replace("px","");0<s?m+=Math.abs(s):m-=Math.abs(s),0<m&&(m=0),m<imageWindow-imageWidth&&(m=imageWindow-imageWidth),image.style.left=m+"px",pointerArray[t].prevPosition.x=l}}}),imageContainer.addEventListener("pointerup",function(e){for(var t=null,r=0;r<pointerArray.length;r++)pointerArray[r].id===e.pointerId&&(t=r);pointerArray.splice(pointerArray[t],1),console.log("up")}),imageContainer.addEventListener("pointercancel",moveToStartPosition);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJidXR0b25NZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJkYXRhIiwiZ3JpZCIsInRlbXBsYXRlIiwibW9kdWxlVGVtcGxhdGUiLCJjb250ZW50IiwibW9kdWxlUGljdHVyZSIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNlbmQiLCJzdGF0dXMiLCJhbGVydCIsInN0YXR1c1RleHQiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJldmVudHMiLCJjcmVhdGVFbGVtZW50RnJvbUhUTUwiLCJodG1sU3RyaW5nIiwiZGl2IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInRyaW0iLCJmaXJzdENoaWxkIiwicGFyc2VUZW1wbGF0ZSIsInZhcmlhYmxlcyIsInJlc3VsdCIsIm91dGVySFRNTCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwicmVwbGFjZSIsImkiLCJsZW5ndGgiLCJtb2R1bGUiLCJjbG9uZU5vZGUiLCJkZXNjcmlwdGlvbiIsImFkZCIsImljb24iLCJwaWN0dXJlIiwiYXBwZW5kQ2hpbGQiLCJpbWFnZUNvbnRhaW5lciIsImltYWdlIiwiaW1hZ2VXaW5kb3ciLCJvZmZzZXRXaWR0aCIsImltYWdlV2lkdGgiLCJzdHlsZSIsImxlZnQiLCJwb2ludGVyQXJyYXkiLCJkaXN0YW5jZVByZXYiLCJtb3ZlVG9TdGFydFBvc2l0aW9uIiwid2luZG93IiwiZXZlbnQiLCJzZXRQb2ludGVyQ2FwdHVyZSIsInBvaW50ZXJJZCIsInB1c2giLCJpZCIsInByZXZQb3NpdGlvbiIsIngiLCJ5IiwiY3VycmVudFBvc2l0aW9uIiwiY29uc29sZSIsImxvZyIsImluZGV4IiwiY3VycmVudFBvc2l0aW9uWDEiLCJjdXJyZW50UG9zaXRpb25ZMSIsImN1cnJlbnRQb3NpdGlvblgyIiwiY3VycmVudFBvc2l0aW9uWTIiLCJkaXN0YW5jZSIsIk1hdGgiLCJzcXJ0IiwicG93IiwiYmFja2dyb3VuZCIsInN0YXJ0WCIsImR4IiwiYWJzIiwic3BsaWNlIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUFhQyxTQUFTQyxjQUFjLG1CQUNwQ0MsS0FBT0YsU0FBU0MsY0FBYyxnQkFFbENGLFdBQVdJLGlCQUFpQixRQUFTLFdBQ25DRCxLQUFLRSxVQUFVQyxPQUFPLHlCQUd4QixJQU9JQyxLQVBBQyxLQUFPUCxTQUFTQyxjQUFjLFNBRTlCTyxTQUFXUixTQUFTQyxjQUFjLG1CQUVsQ1EsZUFBaUJELFNBQVNFLFFBQVFULGNBQWMsV0FDaERVLGNBQWdCSCxTQUFTRSxRQUFRVCxjQUFjLG9CQUkvQ1csSUFBTSxJQUFJQyxlQUNkRCxJQUFJRSxLQUFLLE1BQU8sZUFBZSxHQUMvQkYsSUFBSUcsT0FDYyxLQUFkSCxJQUFJSSxPQUNOQyxNQUFPTCxJQUFJSSxPQUFTLEtBQU9KLElBQUlNLFlBRS9CWixLQUFPYSxLQUFLQyxNQUFNUixJQUFJUyxjQUd4QixJQUFJQyxPQUFTaEIsS0FBS2dCLE9BRWxCLFNBQVNDLHNCQUFzQkMsR0FDN0IsSUFBSUMsRUFBTXpCLFNBQVMwQixjQUFjLE9BRWpDLE9BREFELEVBQUlFLFVBQVlILEVBQVdJLE9BQ3BCSCxFQUFJSSxXQUdiLFNBQVNDLGNBQWN0QixFQUFVdUIsR0FDL0IsSUFBSUMsRUFBU3hCLEVBQVN5QixVQU90QixPQU5BQyxPQUFPQyxLQUFLSixHQUFXSyxRQUFRLFNBQVVDLEdBQ2hCLE9BQW5CTixFQUFVTSxLQUNaTixFQUFVTSxHQUFPLElBRW5CTCxFQUFTQSxFQUFPTSxRQUFRLE1BQVFELEVBQU0sTUFBT04sRUFBVU0sTUFFbERkLHNCQUFzQlMsR0FHL0IsSUFBSyxJQUFJTyxFQUFJLEVBQUdBLEVBQUlqQixPQUFPa0IsT0FBUUQsSUFBSyxDQUV0QyxJQUFJRSxPQUFTaEMsZUFBZWlDLFdBQVUsR0FPdEMsR0FOQUQsT0FBU1gsY0FBY3JCLGVBQWdCYSxPQUFPaUIs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QUdkckIsZUFBZTdDLGlCQUFpQixnQkFBaUJzRCIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGJ1dHRvbk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbWVudS1idXR0b24nKTtcbnZhciBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlci1tZW51Jyk7XG5cbmJ1dHRvbk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gIG1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLW1lbnUtLW9wZW5lZCcpO1xufSk7XG5cbnZhciBncmlkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdyaWQnKTtcblxudmFyIHRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21vZHVsZVRlbXBsYXRlJyk7XG5cbnZhciBtb2R1bGVUZW1wbGF0ZSA9IHRlbXBsYXRlLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZScpO1xudmFyIG1vZHVsZVBpY3R1cmUgPSB0ZW1wbGF0ZS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX3BpY3R1cmUnKTtcblxudmFyIGRhdGE7XG5cbnZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbnhoci5vcGVuKCdHRVQnLCAnZXZlbnRzLmpzb24nLCBmYWxzZSk7XG54aHIuc2VuZCgpO1xuaWYgKHhoci5zdGF0dXMgIT0gMjAwKSB7XG4gIGFsZXJ0KCB4aHIuc3RhdHVzICsgJzogJyArIHhoci5zdGF0dXNUZXh0ICk7XG59IGVsc2Uge1xuICBkYXRhID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbn1cblxudmFyIGV2ZW50cyA9IGRhdGEuZXZlbnRzO1xuXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50RnJvbUhUTUwoaHRtbFN0cmluZykge1xuICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi5pbm5lckhUTUwgPSBodG1sU3RyaW5nLnRyaW0oKTtcbiAgcmV0dXJuIGRpdi5maXJzdENoaWxkO1xufVxuXG5mdW5jdGlvbiBwYXJzZVRlbXBsYXRlKHRlbXBsYXRlLCB2YXJpYWJsZXMpIHtcbiAgdmFyIHJlc3VsdCA9IHRlbXBsYXRlLm91dGVySFRNTDtcbiAgT2JqZWN0LmtleXModmFyaWFibGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBpZiAodmFyaWFibGVzW2tleV0gPT09IG51bGwpIHtcbiAgICAgIHZhcmlhYmxlc1trZXldID0gJyc7XG4gICAgfVxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKCd7eyAnICsga2V5ICsgJyB9fScsIHZhcmlhYmxlc1trZXldKTtcbiAgfSk7XG4gIHJldHVybiBjcmVhdGVFbGVtZW50RnJvbUhUTUwocmVzdWx0KTtcbn1cblxuZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcblxuICB2YXIgbW9kdWxlID0gbW9kdWxlVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICBtb2R1bGUgPSBwYXJzZVRlbXBsYXRlKG1vZHVsZVRlbXBsYXRlLCBldmVudHNbaV0pO1xuXG4gIGlmIChldmVudHNbaV0uZGVzY3JpcHRpb24gPT09ICcnKSB7XG4gICAgbW9kdWxlLnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX21lc3NhZ2UnKS5jbGFzc0xpc3QuYWRkKCdtb2R1bGVfX21lc3NhZ2UtLWRpc2FibGVkJyk7XG4gIH1cblxuICBpZiAoJ2RhdGEnIGluIGV2ZW50c1tpXSkge1xuXG4gICAgaWYgKGV2ZW50c1tpXS5pY29uID09PSAnY2FtJykge1xuICAgICAgdmFyIHBpY3R1cmUgPSBtb2R1bGVQaWN0dXJlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIG1vZHVsZS5xdWVyeVNlbGVjdG9yKCcubW9kdWxlX19tZXNzYWdlJykuYXBwZW5kQ2hpbGQocGljdHVyZSk7XG4gICAgfVxuXG4gIH1cblxuICBncmlkLmFwcGVuZENoaWxkKG1vZHVsZSk7XG59XG5cbnZhciBpbWFnZUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX3BpY3R1cmUnKTtcbnZhciBpbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX2ltYWdlJyk7XG5cbnZhciBpbWFnZVdpbmRvdyA9IGltYWdlQ29udGFpbmVyLm9mZnNldFdpZHRoO1xudmFyIGltYWdlV2lkdGggPSBpbWFnZS5vZmZzZXRXaWR0aDtcblxuaW1hZ2Uuc3R5bGUubGVmdCA9ICcwcHgnO1xuXG52YXIgcG9pbnRlckFycmF5ID0gW107XG52YXIgZGlzdGFuY2VQcmV2ID0gMDtcblxudmFyIG1vdmVUb1N0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbigpIHtcbiAgaW1hZ2VXaW5kb3cgPSBpbWFnZUNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgaW1hZ2Uuc3R5bGUubGVmdCA9ICcwcHgnO1xufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICBtb3ZlVG9TdGFydFBvc2l0aW9uKCk7XG59KTtcblxuaW1hZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaW1hZ2VDb250YWluZXIuc2V0UG9pbnRlckNhcHR1cmUoZXZlbnQucG9pbnRlcklkKTtcblxuICBwb2ludGVyQXJyYXkucHVzaCh7XG4gICAgaWQ6IGV2ZW50LnBvaW50ZXJJZCxcbiAgICBwcmV2UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfSxcbiAgICBjdXJyZW50UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfVxuICB9KTtcblxuICBjb25zb2xlLmxvZyhcImRvd25cIik7XG59KTtcblxuaW1hZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaWYgKHBvaW50ZXJBcnJheS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHZhciBpbmRleCA9IG51bGw7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwb2ludGVyQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAocG9pbnRlckFycmF5W2ldLmlkID09PSBldmVudC5wb2ludGVySWQpIHtcbiAgICAgIGluZGV4ID0gaTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIHBvaW50ZXJBcnJheVtpbmRleF0uY3VycmVudFBvc2l0aW9uLnggPSBldmVudC54O1xuICBwb2ludGVyQXJyYXlbaW5kZXhdLmN1cnJlbnRQb3NpdGlvbi55ID0gZXZlbnQueTtcblxuICBjb25zb2xlLmxvZyhcIm1vdmVcIik7XG5cbiAgaWYgKHBvaW50ZXJBcnJheS5sZW5ndGggPiAxKSB7XG5cbiAgICB2YXIgY3VycmVudFBvc2l0aW9uWDEgPSBwb2ludGVyQXJyYXlbMF0uY3VycmVudFBvc2l0aW9uLng7XG4gICAgdmFyIGN1cnJlbnRQb3NpdGlvblkxID0gcG9pbnRlckFycmF5WzBdLmN1cnJlbnRQb3NpdGlvbi55O1xuICAgIHZhciBjdXJyZW50UG9zaXRpb25YMiA9IHBvaW50ZXJBcnJheVsxXS5jdXJyZW50UG9zaXRpb24ueDtcbiAgICB2YXIgY3VycmVudFBvc2l0aW9uWTIgPSBwb2ludGVyQXJyYXlbMV0uY3VycmVudFBvc2l0aW9uLnk7XG5cbiAgICB2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoTWF0aC5wb3coY3VycmVudFBvc2l0aW9uWDIgLSBjdXJyZW50UG9zaXRpb25YMSkgKyBNYXRoLnBvdyhjdXJyZW50UG9zaXRpb25ZMiAtIGN1cnJlbnRQb3NpdGlvblkxKSk7XG5cbiAgICBpZiAoZGlzdGFuY2VQcmV2KSB7XG5cbiAgICAgIGlmIChkaXN0YW5jZSA+IGRpc3RhbmNlUHJldikge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jykuc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLnN0eWxlLmJhY2tncm91bmQgPSAnYmx1ZSc7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICBkaXN0YW5jZVByZXYgPSBkaXN0YW5jZTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZWJ1ZycpLmlubmVySFRNTCA9IGRpc3RhbmNlUHJldjtcblxuICB9IGVsc2Uge1xuXG4gICAgLy8gbW92ZVxuICAgIHZhciBzdGFydFggPSBwb2ludGVyQXJyYXlbaW5kZXhdLnByZXZQb3NpdGlvbi54O1xuICAgIHZhciB4ID0gZXZlbnQueDtcbiAgICB2YXIgZHggPSB4IC0gc3RhcnRYO1xuICAgIHZhciBsZWZ0ID0gaW1hZ2Uuc3R5bGUubGVmdC5yZXBsYWNlKCdweCcsICcnKSAqIDE7XG5cbiAgICBkeCA+IDAgPyBsZWZ0ICs9IE1hdGguYWJzKGR4KSA6IGxlZnQgLT0gTWF0aC5hYnMoZHgpO1xuXG4gICAgaWYgKGxlZnQgPiAwKSB7XG4gICAgICBsZWZ0ID0gMDtcbiAgICB9XG5cbiAgICBpZiAobGVmdCA8IGltYWdlV2luZG93IC0gaW1hZ2VXaWR0aCkge1xuICAgICAgbGVmdCA9IGltYWdlV2luZG93IC0gaW1hZ2VXaWR0aDtcbiAgICB9XG5cbiAgICBpbWFnZS5zdHlsZS5sZWZ0ID0gbGVmdCArICdweCc7XG4gICAgcG9pbnRlckFycmF5W2luZGV4XS5wcmV2UG9zaXRpb24ueCA9IHg7XG4gIH1cbn0pO1xuXG5pbWFnZUNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVydXAnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgdmFyIGluZGV4ID0gbnVsbDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50ZXJBcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChwb2ludGVyQXJyYXlbaV0uaWQgPT09IGV2ZW50LnBvaW50ZXJJZCkge1xuICAgICAgaW5kZXggPSBpO1xuICAgIH1cbiAgfVxuXG4gIHBvaW50ZXJBcnJheS5zcGxpY2UocG9pbnRlckFycmF5W2luZGV4XSwgMSk7XG5cbiAgY29uc29sZS5sb2coXCJ1cFwiKTtcbn0pO1xuXG5pbWFnZUNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyY2FuY2VsJywgbW92ZVRvU3RhcnRQb3NpdGlvbik7XG5cbiJdfQ==
